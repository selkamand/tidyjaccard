---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# TidyJaccard

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
[![R-CMD-check](https://github.com/selkamand/tidyjaccard/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/selkamand/tidyjaccard/actions/workflows/R-CMD-check.yaml)
[![CRAN status](https://www.r-pkg.org/badges/version/tidyjaccard)](https://CRAN.R-project.org/package=tidyjaccard)
[![Codecov test coverage](https://codecov.io/gh/selkamand/tidyjaccard/branch/master/graph/badge.svg)](https://app.codecov.io/gh/selkamand/tidyjaccard?branch=master)
<!-- badges: end -->

Effortless all vs all Jaccard similarity from tidy dataframes.

## Philosophy

For TidyJaccard to work seamlessly, ensure that your dataframe includes two columns:

1. **sample_identifier**: This column should contain unique identifiers for each sample in your dataset.

2. **set**: Each row in this column defines an element within the set corresponding to the respective sample identifier. This column plays a pivotal role in calculating Jaccard similarity.

Names of columns doesn't matter. 



## Installation

You can install the development version of tidyjaccard like so:

``` r
remotes::install_github('selkamand/tidyjaccard')
```


## Getting Started


Here's an example [dataset](https://github.com/selkamand/tidyjaccard/blob/master/inst/smith_and_johnson.csv) describing physical traits of two families

- Family 1: Smith (5 members)

- Family 2: Johnson (3 members)

*Research Question:* Which people in the dataset are most physically similar to one another? Do they tend to come from the same family?

For each member of the family, we've recorded physical traits. Each row in our dataset describes one trait present in one individual.

Lets look at the data:

```{r}
# Read data
path_data <- system.file(package='tidyjaccard', 'smith_and_johnson.csv')
df_family <- read.csv(path_data)

# Print data
head(df_family)
```

Now lets compute similarity between each person by their traits

```{R Example}
library(tidyjaccard)

nodePar <- list(lab.cex = 0.6, pch = c(NA, 19), 
                cex = 0.7, col = "blue")

df_family |>
  tidy_pairwise_jaccard_similarity(col_sample = "name", col_trait = "trait") |> # Compute Jaccard Similarity
  tidy_toggle_simdist() |> # Convert similarity to distance
  tidy_to_matrix() |> # Convert to matrix
  matrix_to_dist_class() |> # Convert matrix to 'dist' class (for compatibility with hclust)
  hclust(method = "single") |> # Do heirarchical clustering
  as.dendrogram() |>
  set("branches_k_color", k = 2) |>
  #plot(xlab = "average", horiz = TRUE) # Plot result
  plot(xlab = "Distance", horiz = TRUE, type = "rectangle", nodePar = nodePar) 
  # Plot result 

df_family |>
  tidy_pairwise_jaccard_similarity(col_sample = "name", col_trait = "trait") |> # Compute Jaccard Similarity
  tidy_toggle_simdist() |> # Convert similarity to distance
  tidy_to_matrix() |> # Convert to matrix
  matrix_to_dist_class() |> # Convert matrix to 'dist' class (for compatibility with hclust)
  hclust(method = "single") |> # Do heirarchical clustering
  ape::as.phylo() |> 
  #plot(xlab = "average", horiz = TRUE) # Plot result
  plot(type = "fan", cex = 0.6, no.margin = TRUE)


#Write your tree to a newick file:
  
df_family |>
  tidy_pairwise_jaccard_similarity(col_sample = "name", col_trait = "trait") |> # Compute Jaccard Similarity
  tidy_toggle_simdist() |> # Convert similarity to distance
  tidy_to_matrix() |> # Convert to matrix
  matrix_to_dist_class() |> # Convert matrix to 'dist' class (for compatibility with hclust)
  hclust(method = "single") |> # Do heirarchical clustering

df_family |>
  tidy_pairwise_jaccard_similarity(col_sample = "name", col_trait = "trait") |> # Compute Jaccard Similarity
  tidy_toggle_simdist() |> # Convert similarity to distance
  tidy_to_matrix() |> # Convert to matrix
  matrix_to_dist_class() |> # Convert matrix to 'dist' class (for compatibility with hclust)
  hclust(method = "single") |> # Do heirarchical clustering
  as.dendrogram() |>
  dendogram_ggraph()
```



## Other Applications

RNAseq data

- col_sample = sample identifier
- col_trait = over_expressed_genes


Microbiome data

- col_sample = sample identifier
- col_trait = microbes present

